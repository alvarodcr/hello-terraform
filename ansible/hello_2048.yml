---
- name: Install hello-2048
  hosts: all
  become: true
  gather_facts: false
  vars:
    ansible_user: ec2-user

  tasks:
    - name: Wait for SSH to come up
      wait_for_connection:
        delay: 10
        sleep: 5
        timeout: 300

    - name: Install Apache HTTP Server
      yum:
        name: httpd
        state: latest

    - name: Start Apache HTTP Server
      service:
        name: httpd
        state: started

    - name: Create directory /app
      file:
        path: /home/ec2-user/app
        state: directory
        owner: ec2-user
        group: ec2-user
        mode: 0755

    - name: Clone the repository ZIP to /app
      command: wget https://github.com/alvarodcr/hello-2048/archive/refs/heads/main.zip

    - name: Unzip main.zip
      command: unzip main.zip

    - name: Move main.zip to /app
      command: mv v /home/ec2-user/main.zip /home/ec2-user/app/
      command: mv /home/ec2-user/hello-2048-main/ /home/ec2-user/app/
   
    - name: Move /public_html to /var/www/
      command: sudo cp -av /home/ec2-user/app/hello-2048-main/public_html/* /var/www/html/
      become: true












